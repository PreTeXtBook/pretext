<?xml version="1.0" encoding="UTF-8" ?>

<!--********************************************************************
Copyright 2016 Robert A. Beezer

This file is part of MathBook XML.

MathBook XML is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 2 or version 3 of the
License (at your option).

MathBook XML is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with MathBook XML.  If not, see <http://www.gnu.org/licenses/>.
*********************************************************************-->
<!-- This file was originally part of the book     -->
<!-- (as copied on 2016/03/25)                     -->
<!--                                               -->
<!--   Abstract Algebra: Theory and Applications   -->
<!--                                               -->
<!-- Copyright (C) 1997-2014  Thomas W. Judson     -->

<chapter xml:id="cyclic" xmlns:xi="http://www.w3.org/2001/XInclude">
    <title>Cyclic Groups</title>
    <!-- A sample short title for testing purposes, -->
    <!-- Not really necessary content-wise          -->
    <shorttitle>Cyclicity</shorttitle>

    <introduction>
        <p>The groups <m>\mathbb Z</m> and <m>{\mathbb Z}_n</m>, which are among the most familiar and easily understood groups, are both examples of what are called cyclic groups.  In this chapter we will study the properties of cyclic groups and cyclic subgroups, which play a fundamental part in the classification of all abelian groups.</p>
    </introduction>

    <section>
        <title>Cyclic groups</title>

        <p>Often a subgroup will depend entirely on a single element of the group; that is, knowing that particular element will allow us to compute any other element in the subgroup.</p>

        <!-- RAB 2014/08/18 Maybe this id should have 3z, not z3? -->
        <example xml:id="example-cyclic-z3">
            <title>An Infinite Cyclic Subgroup, Modular Addition</title>
           <p>Suppose that we consider <m>3 \in {\mathbb Z}</m> and look at all multiples (both positive and negative) of 3.  As a set, this is <me>3 {\mathbb Z} = \{ \ldots, -3, 0, 3, 6, \ldots \}</me>. It is easy to see that <m>3 {\mathbb Z}</m> is a subgroup of the integers.  This subgroup is completely determined by the element 3 since we can obtain all of the other elements of the group by taking multiples of 3.  Every element in the subgroup is <q>generated</q> by 3.</p>
        </example>

        <example xml:id="example-cyclic-2n">
            <title>An Infinite Cyclic Subgroup, Multiplication of Rational Numbers</title>
            <p>If <m>H = \{ 2^n : n \in {\mathbb Z} \}</m>, then <m>H</m> is a subgroup of the multiplicative group of nonzero rational numbers, <m>{\mathbb Q}^*</m>.  If <m>a = 2^m</m> and <m>b = 2^n</m> are in <m>H</m>, then <m>ab^{-1} = 2^m 2^{-n} = 2^{m-n}</m> is also in <m>H</m>.  By <xref ref="proposition-subgroup" />, <m>H</m> is a subgroup of <m>{\mathbb Q}^*</m> determined by the element 2.</p>
        </example>

        <theorem xml:id="theorem-cyclic-subgroup">
            <statement>
                <p>Let <m>G</m> be a group and <m>a</m> be any element in <m>G</m>.  Then the set <me>\langle a \rangle  = \{ a^k : k \in {\mathbb Z} \}</me> is a subgroup of <m>G</m>.  Furthermore, <m>\langle a \rangle</m> is the smallest subgroup of <m>G</m> that contains~<m>a</m>.<notation>
                    <usage>\langle a \rangle</usage>
                    <description>cyclic group generated by <m>a</m></description>
                </notation></p>
            </statement>
            <proof>
                <p>The identity is in <m>\langle a \rangle </m> since <m>a^0 = e</m>. If <m>g</m> and <m>h</m> are any two elements in <m>\langle a \rangle </m>, then by the definition of <m>\langle a \rangle</m> we can write <m>g = a^m</m> and <m>h = a^n</m> for some integers <m>m</m> and <m>n</m>. So <m>gh = a^m a^n = a^{m+n}</m> is again in <m>\langle a \rangle </m>. Finally, if <m>g = a^n</m> in <m>\langle a \rangle </m>, then the inverse <m>g^{-1} = a^{-n}</m> is also in <m>\langle a \rangle </m>. Clearly, any subgroup <m>H</m> of <m>G</m> containing <m>a</m> must contain all the powers of <m>a</m> by closure; hence, <m>H</m> contains <m>\langle a \rangle </m>. Therefore, <m>\langle a \rangle </m> is the smallest subgroup of <m>G</m> containing <m>a</m>.</p>
            </proof>
        </theorem>

        <remark>
            <p>If we are using the <q>+</q> notation, as in the case of the integers under addition, we write <m>\langle a \rangle  = \{ na : n \in {\mathbb Z} \}</m>.</p>
        </remark>

        <p>For <m>a \in G</m>, we call <m>\langle a \rangle </m> the <term>cyclic subgroup</term><idx><h>Subgroup</h><h>cyclic</h></idx> generated by <m>a</m>. If <m>G</m> contains some element <m>a</m> such that <m>G = \langle a \rangle </m>, then <m>G</m> is a <term>cyclic group</term><idx><h>Group</h><h>cyclic</h></idx>. In this case <m>a</m> is a <term>generator</term><idx><h>Generator of a cyclic subgroup</h></idx> of <m>G</m>.  If <m>a</m> is an element of a group <m>G</m>, we define the <term>order</term><idx><h>Element</h><h>order of</h></idx> of <m>a</m> to be the smallest positive integer <m>n</m> such that <m>a^n= e</m>, and we write <m>|a| = n</m>. <notation><usage>|a|</usage><description>the order of an element <m>a</m></description></notation> If there is no such integer <m>n</m>, we say that the order of <m>a</m> is infinite and  write <m>|a| = \infty</m> to denote the order of <m>a</m>.</p>

        <example xml:id="example-cyclic-z6">
            <title>Generators of a Finite Cyclic Group</title>
            <p>Notice that a cyclic group can have more than a single generator. Both 1 and 5 generate <m>{\mathbb Z}_6</m>; hence, <m>{\mathbb Z}_6</m> is a cyclic group. Not every element in a cyclic group is necessarily a generator of the group. The order of <m>2 \in {\mathbb Z}_6</m> is 3. The cyclic subgroup generated by 2 is <m>\langle 2 \rangle  = \{ 0, 2, 4 \}</m>.</p>
        </example>

        <p>The groups <m>{\mathbb Z}</m> and <m>{\mathbb Z}_n</m> are cyclic groups. The elements 1 and <m>-1</m> are generators for <m>{\mathbb Z}</m>.  We can certainly generate <m>{\mathbb Z}_n</m> with 1 although there may be other generators of <m>{\mathbb Z}_n</m>, as in the case of <m>{\mathbb Z}_6</m>.</p>

        <example xml:id="example-cyclic-u9">
            <title>A Cyclic Group of Units</title>
            <p>The group of units, <m>U(9)</m>, in <m>{\mathbb Z}_9</m> is a cyclic group.  As a set, <m>U(9)</m> is <m>\{ 1, 2, 4, 5, 7, 8  \}</m>. The element 2 is a generator for <m>U(9)</m> since<md>
                <mrow>2^1 &amp; = 2 \qquad 2^2 = 4</mrow>
                <mrow>2^3 &amp; = 8 \qquad 2^4 = 7</mrow>
                <mrow>2^5 &amp; =  5 \qquad 2^6 = 1</mrow>
            </md>.</p>
        </example>

        <example xml:id="example-cyclic-s3-not-cyclic">
            <title>A Group That is Not Cyclic</title>
            <p>Not every group is a cyclic group.  Consider the symmetry group of an equilateral triangle <m>S_3</m>.  The subgroups of <m>S_3</m> are shown in <xref ref="figure-subgrps-s3" />.  Notice that every subgroup is cyclic; however, no single element generates the entire group.</p>
        </example>

        <figure xml:id="figure-subgrps-s3">
            <caption>Subgroups of <m>S_3</m></caption>
            <!-- Replaced figure with tikz figure - TWJ 5/6/2010 -->
            <image xml:id="cyclic-s3-subgroups">
                <latex-image><![CDATA[
                    \begin{tikzpicture}[scale=1]

                    \draw  (0,0.3) -- (2.6,1.2);
                    \draw  (2,0.3) -- (2.8,1.2);
                    \draw  (4,0.3) -- (3.2,1.2);
                    \draw  (6,0.3) -- (3.4,1.2);

                    \draw  (0,-0.3) -- (2.6,-1.2);
                    \draw  (2,-0.3) -- (2.8,-1.2);
                    \draw  (4,-0.3) -- (3.2,-1.2);
                    \draw  (6,-0.3) -- (3.4,-1.2);

                    \node at (0, 0) {$\{  \identity, \rho_1, \rho_2\}$};
                    \node at (2, 0) {$\{  \identity, \mu_1\}$};
                    \node at (4, 0) {$\{  \identity, \mu_2 \}$};
                    \node at (6, 0) {$\{  \identity, \mu_3 \}$};
                    \node at (3, 1.5) {$S_3$};
                    \node at (3,-1.5) {$\{ \identity \}$};
                    \end{tikzpicture}]]>
                </latex-image>
            </image>
        </figure>

        <theorem xml:id="theorem-cyclic-abelian">
            <statement>
                <p>Every cyclic group is abelian.</p>
            </statement>
            <proof>
                <p>Let <m>G</m> be a cyclic group and <m>a \in G</m> be a generator for <m>G</m>. If <m>g</m> and <m>h</m> are in <m>G</m>, then they can be written as powers of <m>a</m>, say <m>g = a^r</m> and <m>h = a^s</m>. Since <me>g  h = a^r a^s = a^{r+s} = a^{s+r} = a^s a^r = h g</me>, <m>G</m> is abelian.</p>
            </proof>
        </theorem>
    </section>

    <section>
        <title>Subgroups of a Cyclic Group</title>

        <p>We can ask some interesting questions about cyclic subgroups of a group and subgroups of a cyclic group.  If <m>G</m> is a group, which subgroups of <m>G</m> are cyclic? If <m>G</m> is a cyclic group, what type of subgroups does <m>G</m> possess?</p>

        <theorem xml:id="theorem-cyclic-subgroups">
            <statement>
                <p>Every subgroup of a cyclic group is cyclic.</p>
            </statement>
            <proof>
                <p>The main tools used in this proof are the division algorithm and the Principle of Well-Ordering. Let <m>G</m> be a cyclic group generated by <m>a</m> and suppose that <m>H</m> is a subgroup of <m>G</m>. If <m>H = \{ e \}</m>, then trivially <m>H</m> is cyclic. Suppose that <m>H</m> contains some other element <m>g</m> distinct from the identity. Then <m>g</m> can be written as <m>a^n</m> for some integer <m>n</m>. Since <m>H</m> is a subgroup, <m>g^{-1} = a^{n}</m> must also be in <m>H</m>.  Since either <m>n</m> or <m>-n</m> is postive, we can assume that <m>H</m> contains positve powers of <m>a</m> and <m>n \gt 0</m>. Let <m>m</m> be the smallest natural number such that <m>a^m \in H</m>. Such an <m>m</m> exists by the Principle of Well-Ordering.</p>

                <p>We claim that <m>h = a^m</m> is a generator for <m>H</m>.  We must show that every <m>h' \in H</m> can be written as a power of <m>h</m>. Since <m>h' \in H</m> and <m>H</m> is a subgroup of <m>G</m>, <m>h' = a^k</m> for some integer <m>k</m>. Using the division algorithm, we can find numbers <m>q</m> and <m>r</m> such that <m>k = mq +r</m> where <m>0 \leq r \lt m</m>; hence, <me>a^k = a^{mq +r} = (a^m)^q a^r = h^q a^r</me>. So <m>a^r = a^k h^{-q}</m>. Since <m>a^k</m> and <m>h^{-q}</m> are in <m>H</m>, <m>a^r</m> must also be in <m>H</m>.  However, <m>m</m> was the smallest positive number such that <m>a^m</m> was in <m>H</m>; consequently, <m>r=0</m> and so <m>k=mq</m>. Therefore, <me>h' = a^k = a^{mq} =  h^q</me>
                and <m>H</m> is generated by <m>h</m>.</p>
            </proof>
        </theorem>

        <corollary>
            <statement>
                <p>The subgroups of <m>{\mathbb Z}</m> are exactly <m>n{\mathbb Z}</m> for <m>n = 0, 1, 2,\ldots</m>.</p>
            </statement>
        </corollary>

        <proposition xml:id="proposition-cyclic-subgrp-order">
            <statement>
                <p>Let <m>G</m> be a cyclic group of order <m>n</m> and suppose that <m>a</m> is a generator for  <m>G</m>. Then <m>a^k=e</m> if and only if <m>n</m> divides <m>k</m>.</p>
            </statement>
            <proof>
                <p>First suppose that <m>a^k=e</m>. By the division algorithm, <m>k = nq + r</m> where <m>0 \leq r \lt n</m>; hence, <me>e = a^k = a^{nq + r} = a^{nq} a^r = e a^r = a^r</me>. Since the smallest positive integer <m>m</m> such that <m>a^m = e</m> is <m>n</m>, <m>r= 0</m>.</p>

                <p>Conversely, if <m>n</m> divides <m>k</m>, then <m>k=ns</m> for some integer <m>s</m>. Consequently, <me>a^k = a^{ns} = (a^n)^s = e^s = e</me>.</p>
            </proof>
        </proposition>

            <theorem xml:id="theorem-cyclic-orders">
            <statement>
                <p>Let <m>G</m> be a cyclic group of order <m>n</m> and suppose that <m>a \in G</m> is a generator of the group.  If <m>b = a^k</m>, then the order of <m>b</m> is <m>n/d</m>, where <m>d = \gcd(k,n)</m>.</p>
            </statement>
            <proof>
                <p>We wish to find the smallest integer <m>m</m> such that <m>e = b^m = a^{km}</m>. By <xref ref="proposition-cyclic-subgrp-order" />, this is the smallest integer <m>m</m> such that <m>n</m> divides <m>km</m> or, equivalently, <m>n/d</m> divides <m>m(k/d)</m>.  Since <m>d</m> is the greatest common divisor of <m>n</m> and <m>k</m>, <m>n/d</m> and <m>k/d</m> are relatively prime. Hence, for <m>n/d</m> to divide <m>m(k/d)</m> it must divide <m>m</m>.  The smallest such <m>m</m> is <m>n/d</m>.</p>
            </proof>
        </theorem>

        <corollary xml:id="corollary-cyclic-modngenerators">
            <statement>
                <p>The generators of <m>{\mathbb Z}_n</m> are the integers <m>r</m> such that <m>1 \leq r \lt n</m> and <m>\gcd(r,n) =  1</m>.</p>
                </statement>
            </corollary>

        <example xml:id="example-cyclic-z16">
            <title>A Finite Cyclic Group of Order <m>16</m></title>
            <p>Let us examine the group <m>{\mathbb Z}_{16}</m>.  The numbers 1, 3, 5, 7, 9, 11, 13, and 15 are the elements of <m>{\mathbb Z}_{16}</m> that are relatively prime to 16.  Each of these elements generates <m>{\mathbb Z}_{16}</m>. For example, <md>
                <mrow>1 \cdot 9  &amp; =  9  &amp;  2 \cdot 9  &amp; = 2  &amp; 3 \cdot 9  &amp; = 11</mrow>
                <mrow>4 \cdot 9  &amp; =  4  &amp;  5 \cdot 9  &amp; = 13 &amp;     6 \cdot 9 &amp; = 6</mrow>
                <mrow>7 \cdot 9  &amp; =  15 &amp; 8 \cdot 9  &amp; = 8  &amp;  9 \cdot 9 &amp;  = 1</mrow>
                <mrow>10 \cdot 9 &amp; =  10 &amp; 11 \cdot 9 &amp; = 3  &amp; 12 \cdot 9 &amp;  = 12</mrow>
                <mrow>13 \cdot 9 &amp; =  5 &amp; 14 \cdot 9 &amp; = 14 &amp;   15 \cdot 9 &amp; = 7</mrow>
            </md>.</p>
        </example>
    </section>

    <section>
        <title>Cyclic Groups of Complex Numbers</title>

        <p>The <term>complex numbers</term> are defined as <me>{\mathbb C} = \{ a + bi : a, b \in {\mathbb R} \}</me>, where <m>i^2 = -1</m>.  If <m>z = a + bi</m>, then <m>a</m> is the <term>real part</term> of <m>z</m> and <m>b</m> is the <term>imaginary part</term> of <m>z</m>.</p>

        <p>To add two complex numbers <m>z=a+bi</m> and <m>w= c+di</m>, we just add the corresponding real and imaginary parts: <me>z + w=(a + bi ) + (c + di)  =  (a + c) + (b + d)i</me>. Remembering that <m>i^2 = -1</m>,  we multiply complex numbers just like polynomials. The product of <m>z</m> and <m>w</m> is <me>(a + bi )(c + di)  =   ac + bdi^2 + adi + bci =  (ac -bd) +(ad + bc)i</me>.</p>

        <p>Every nonzero complex number <m>z = a +bi</m> has a multiplicative inverse; that is, there exists a <m>z^{-1} \in {\mathbb C}^\ast</m> such that <m>z z^{-1} = z^{-1} z = 1</m>. If <m>z = a + bi</m>, then <me>z^{-1} = \frac{a-bi}{ a^2 + b^2  }</me>. The <term>complex conjugate</term><idx><h>Conjugate, complex</h></idx> of a complex number <m>z = a + bi</m> is defined to be <m>\overline{z} = a- bi</m>.  The <term>absolute value</term> or <term>modulus</term> of  <m>z = a + bi</m>  is <m>|z| = \sqrt{a^2 + b^2}</m>.</p>

        <example xml:id="example-cyclic-complex-add">
            <title>Complex Number Operations</title>
            <p>Let <m>z = 2 + 3i</m> and <m>w = 1-2i</m>. Then <me>z + w = (2 + 3i) + (1 - 2i) = 3 + i</me> and <me>z  w = (2 + 3i)(1 - 2i ) = 8 - i</me>. Also,<md>
                <mrow>z^{-1} &amp; = \frac{2}{13} - \frac{3}{13}i</mrow>
                <mrow>|z| &amp; = \sqrt{13}</mrow>
                <mrow>\overline{z} &amp; = 2-3i</mrow>
            </md>.</p>
        </example>

        <figure xml:id="figure-rectcoord">
            <caption>Rectangular coordinates of a complex number</caption>
            <!-- Replaced figure with tikz figure - TWJ 5/6/2010 -->
            <image xml:id="cyclic-complex-rectangular">
                <latex-image><![CDATA[
                    \begin{tikzpicture}[scale=0.5]

                    \draw [->]  (0,-5) -- (0,5);
                    \draw  [->] (-8,0) -- (8,0);
                    \node [right] at (0,5) {$y$};
                    \node [below] at (8,0) {$x$};
                    \node [below] at (0.5,0) {$0$};

                    \filldraw[fill=black, draw=black] (2,3) circle (0.05cm);
                    \node [right] at (2,3) {$z_1 = 2 + 3i$};

                    \filldraw[fill=black, draw=black] (-3,2) circle (0.05cm);
                    \node [left] at (-3, 2) {$z_3 = -3 + 2i$};

                    \filldraw[fill=black, draw=black] (1,-2) circle (0.05cm);
                    \node [right] at (1, -2) {$z_2 = 1 -  2i$};

                    \end{tikzpicture}]]>
                </latex-image>
            </image>
        </figure>

        <p>There are several ways of graphically representing complex numbers. We can represent a complex number <m>z = a +bi</m> as an ordered pair on the <m>xy</m> plane where <m>a</m> is the <m>x</m> (or real) coordinate and <m>b</m> is the <m>y</m> (or imaginary) coordinate. This is called the <term>rectangular</term> or <term>Cartesian</term> representation. The rectangular representations of <m>z_1 = 2 + 3i</m>, <m>z_2 = 1 - 2i</m>, and <m>z_3 = - 3 + 2i</m> are depicted in <xref ref="figure-rectcoord" />.</p>

        <figure xml:id="figure-polarcoord">
            <caption>Polar coordinates of a complex number</caption>
            <!-- Replaced figure with tikz figure - TWJ 5/6/2010 -->
            <image xml:id="cyclic-complex-polar">
                <latex-image><![CDATA[
                    \begin{tikzpicture}[scale=0.5]

                    \draw [->]  (0,-5) -- (0,5);
                    \draw  [->] (-8,0) -- (8,0);
                    \node [right] at (0,5) {$y$};
                    \node [below] at (8,0) {$x$};
                    \node [below] at (0.5,0) {$0$};

                    \draw (0,0) -- (35:6);
                    \draw (2,0) arc (0:35:2);

                    \filldraw[fill=black, draw=black] (35:6) circle (0.05cm);
                    \node [right] at (35:6) {$a + bi$};
                    \node [above] at (35:3) {$r$};
                    \node [right] at (17:2) {$\theta$};

                    \end{tikzpicture}]]>
                </latex-image>
            </image>
        </figure>

        <p>Nonzero complex numbers can also be represented using <term>polar coordinates</term>.  To specify  any nonzero point on the plane, it suffices to give an angle <m>\theta</m> from the positive <m>x</m> axis in the counterclockwise direction and a distance <m>r</m> from the origin, as in <xref ref="figure-polarcoord" />. We can see that <me>z = a + bi = r( \cos \theta + i \sin \theta)</me>. Hence, <me>r = |z| = \sqrt{a^2 + b^2}</me> and <md>
            <mrow>a &amp; = r \cos \theta</mrow>
            <mrow>b &amp; = r \sin \theta</mrow>
        </md>. We sometimes abbreviate <m>r( \cos \theta + i \sin \theta)</m> as <m>r \cis \theta</m>.  To assure that the representation of <m>z</m> is  well-defined, we also require that <m>0^{\circ} \leq \theta \lt 360^{\circ}</m>.  If the measurement is in radians, then <m>0 \leq \theta \lt2 \pi</m>.<notation>
            <usage>\cis \theta</usage>
            <description><m>\cos \theta + i \sin \theta</m></description>
        </notation></p>

        <example xml:id="example-cyclic-polar">
            <title>Complex Numbers in Polar Form</title>
            <p>Suppose that <m>z = 2 \cis  60^{\circ}</m>. Then <me>a = 2 \cos 60^{\circ} = 1</me> and <me>b = 2 \sin 60^{\circ} = \sqrt{3}</me>. Hence, the rectangular representation is <m>z = 1+\sqrt{3}\, i</m>.</p>

            <p>Conversely, if we are given a rectangular representation of a complex number, it is often useful to know the number's polar representation. If <m>z = 3 \sqrt{2} - 3 \sqrt{2}\, i</m>, then <me>r = \sqrt{a^2 + b^2} = \sqrt{36 } = 6</me> and <me>\theta = \arctan \left( \frac{b}{a} \right) = \arctan( - 1) = 315^{\circ}</me>, so <m>3 \sqrt{2} - 3 \sqrt{2}\, i=6 \cis  315^{\circ}</m>.</p>
        </example>

        <p>The polar representation of a complex number makes it easy to find products and powers of complex numbers.  The proof of the following proposition is straightforward and is left as an exercise.</p>

        <proposition xml:id="proposition-polar-mult">
            <statement>
                <p>Let <m>z = r \cis \theta</m> and <m>w = s \cis \phi</m> be two nonzero complex numbers. Then <me>zw = r s \cis( \theta + \phi)</me>.</p>
            </statement>
        </proposition>

        <example xml:id="example-cyclic-polar-mult">
            <title>Multiplication of Complex Numbers in Polar Form</title>
            <p>If <m>z =  3 \cis( \pi / 3 )</m> and <m>w = 2 \cis(\pi / 6 )</m>, then <m>zw = 6 \cis( \pi / 2 ) = 6i</m>.</p>
        </example>

        <theorem xml:id="theorem-demoivre">
            <title>DeMoivre</title>
            <idx><h>DeMoivre's Theorem</h></idx>
            <statement>
                <p>Let <m>z = r \cis  \theta</m> be a nonzero complex number. Then <me>[r \cis \theta  ]^n = r^n \cis( n \theta)</me> for <m>n = 1, 2, \ldots</m>.</p>
            </statement>
            <proof>
                <p>We will use induction on <m>n</m> (see <xref ref="section-math-induction" />). For <m>n = 1</m> the theorem is trivial. Assume that the theorem is true for all <m>k</m> such that <m>1  \leq k \leq n</m>. Then<md>
                    <mrow>z^{n+1} &amp; = z^n z</mrow>
                    <mrow>&amp; = r^n( \cos  n \theta + i \sin n \theta ) r( \cos \theta + i\sin \theta )</mrow>
                    <mrow>&amp; = r^{n+1} [( \cos n \theta \cos \theta - \sin n \theta \sin \theta ) + i ( \sin n \theta \cos \theta + \cos n \theta \sin \theta)]</mrow>
                    <mrow>&amp; = r^{n+1} [ \cos( n \theta + \theta) + i \sin( n \theta + \theta) ]</mrow>
                    <mrow>&amp; = r^{n+1} [ \cos( n +1) \theta + i \sin( n+1) \theta  ]</mrow>
                </md>.</p>
            </proof>
        </theorem>

        <example>
            <title>Powers of Complex Numbers</title>
            <p>Suppose that <m>z= 1+i</m> and we wish to compute <m>z^{10}</m>. Rather than computing <m>(1 + i)^{10}</m> directly, it is much easier to switch to polar coordinates and calculate <m>z^{10}</m> using DeMoivre's Theorem:<md>
                <mrow>z^{10} &amp; = (1+i)^{10}</mrow>
                <mrow>&amp; = \left( \sqrt{2} \cis \left( \frac{\pi }{4} \right) \right)^{10}</mrow>
                <mrow> &amp; = ( \sqrt{2}\, )^{10} \cis \left( \frac{5\pi }{2} \right)</mrow>
                <mrow>&amp; = 32  \cis \left( \frac{\pi }{2} \right)</mrow>
                <mrow>&amp; = 32i</mrow>
            </md>.</p>
        </example>

        <p>The multiplicative group of the complex numbers, <m>{\mathbb C}^*</m>, possesses some interesting subgroups.  Whereas <m>{\mathbb Q}^*</m> and <m>{\mathbb R}^*</m> have no interesting subgroups of finite order, <m>{\mathbb C}^*</m> has many. We first consider the <term>circle group</term><idx><h>Group</h><h>circle</h></idx>, <me>{\mathbb T} = \{ z \in {\mathbb C} : |z| = 1 \}</me>. The following proposition is a direct result of <xref ref="proposition-polar-mult" />.<notation>
            <usage>\mathbb T</usage>
            <description>the circle group</description>
        </notation></p>

        <proposition>
            <statement>
                <p>The circle group is a subgroup of  <m>{\mathbb C}^*</m>.</p>
            </statement>
        </proposition>

        <p>Although the circle group has infinite order, it has many interesting finite subgroups. Suppose that <m>H = \{ 1, -1, i, -i \}</m>. Then <m>H</m> is a subgroup of the circle group. Also, <m>1</m>, <m>-1</m>, <m>i</m>, and <m>-i</m> are exactly those complex numbers that satisfy the equation <m>z^4 = 1</m>. The complex numbers satisfying the equation <m>z^n=1</m> are called the <term><m>n</m>th roots of unity</term><idx><h><m>n</m>th root of unity</h></idx>.</p>

        <theorem>
            <statement>
                <p>If <m>z^n = 1</m>, then the <m>n</m>th roots of unity are <me>z = \cis\left( \frac{2 k \pi}{n } \right)</me>, where <m>k = 0, 1, \ldots, n-1</m>. Furthermore, the <m>n</m>th roots of unity form a cyclic subgroup of <m>{\mathbb T}</m> of order <m>n</m></p>
            </statement>
            <proof>
                <p>By DeMoivre's Theorem, <me>z^n = \cis \left( n \frac{2 k \pi}{n } \right) = \cis( 2 k \pi ) = 1</me>. The <m>z</m>'s are distinct since the numbers <m>2 k \pi /n</m> are all distinct and are greater than or equal to 0 but less than <m>2 \pi</m>.  We will leave the proof that the <m>n</m>th roots of unity form a cyclic subgroup of <m>{\mathbb T}</m> as an exercise.</p>
            </proof>
        </theorem>

        <p>A generator for the group of the <m>n</m>th roots of unity is called a <term>primitive <m>n</m>th root of unity</term><idx><h>Primitive <m>n</m>th root of unity</h></idx>.</p>

        <example xml:id="example-roots_unity">
            <title>Roots of Unity</title>
            <p>The 8th roots of unity can be represented as eight equally spaced points on the unit circle (<xref ref="figure-rtsunity" />).  The primitive 8th roots of unity are<md>
                <mrow>\omega &amp; = \frac{\sqrt{2}}{2}  + \frac{\sqrt{2}}{2} i</mrow>
                <mrow>\omega^3 &amp; = -\frac{\sqrt{2}}{2}  + \frac{\sqrt{2}}{2} i</mrow>
                <mrow>\omega^5 &amp; = -\frac{\sqrt{2}}{2}  - \frac{\sqrt{2}}{2} i</mrow>
                <mrow>\omega^7 &amp; = \frac{\sqrt{2}}{2}  - \frac{\sqrt{2}}{2}i. </mrow>
            </md></p>
        </example>

        <figure xml:id="figure-rtsunity">
            <caption>8th roots of unity</caption>
            <!-- Replaced figure with tikz figure - TWJ 5/6/2010 -->
            <image xml:id="cyclic-roots-unity">
                <latex-image><xi:include href="tikz/cyclic-roots-unity.tex" parse="text" /></latex-image>
            </image>
        </figure>

        <p>We interrupt this exposition to repeat the previous diagram, wrapped as different figure with a different caption.  The TikZ code to produce these diagrams lives in an external file, <c>tikz/cyclic-roots-unity.tex</c>, which is pure text, freed from any need to format for XML processing.  So, in particular, there is no need to escape ampersands and angle brackets, nor is there employment of the <c>CDATA</c> mechanism.  But the real value is that there is just one version to edit, and any changes will be reflected in both copies.</p>

        <figure xml:id="figure-rtsunity-copy">
            <caption>Repeat: 8th roots of unity</caption>
            <image xml:id="cyclic-roots-unity-copy">
                <latex-image><xi:include href="tikz/cyclic-roots-unity.tex" parse="text" /></latex-image>
            </image>
        </figure>
    </section>

    <section>
        <title>Large Powers of Integers</title>

        <p>Computing large powers can be very time-consuming. Just as anyone can compute <m>2^2</m> or <m>2^8</m>, everyone knows how to compute
            <me>2^{2^{1000000} }</me>.
        However, such numbers are so large that we do not want to attempt the calculations; moreover, past a certain point the computations would not be feasible even if we had every computer in the world at our disposal. Even writing down the decimal representation of a very large number may not be reasonable. It could be thousands or even millions of digits long. However, if we could compute something like <m>2^{37398332 } \pmod{ 46389}</m>, we could very easily write the result down since it would be a number between 0 and 46,388. If we want to compute powers modulo <m>n</m> quickly and efficiently, we will have to be clever.<fn>The results in this section are needed only in <xref ref="integers"/> (not really).</fn></p>

        <p>The first thing to notice is that any number <m>a</m> can be written as the sum of distinct powers of 2; that is, we can write <me>a = 2^{k_1} + 2^{k_2} + \cdots + 2^{k_n}</me>, where <m>k_1 \lt k_2 \lt \cdots \lt k_n</m>.  This is just the binary representation of <m>a</m>. For example, the binary representation of 57 is 111001, since we can write <m>57 = 2^0 + 2^3 + 2^4 + 2^5</m>.</p>

        <p>The laws of exponents still work in <m>{\mathbb Z}_n</m>; that is, if <m>b \equiv a^x \pmod{ n}</m> and <m>c \equiv a^y \pmod{ n}</m>, then <m>bc \equiv a^{x+y} \pmod{ n}</m>. We can compute <m>a^{2^k} \pmod{ n}</m> in <m>k</m> multiplications by computing<md>
            <mrow>a^{2^0} \pmod{ n}</mrow>
            <mrow>a^{2^1} \pmod{ n }</mrow>
            <mrow>\vdots</mrow>
            <mrow>a^{2^k} \pmod{ n}</mrow>
        </md>.  Each step involves squaring the answer obtained in the previous step, dividing by <m>n</m>, and taking the remainder.</p>

        <example xml:id="example-cyclic-repeated-squares">
            <title>Repeated Squares</title>
            <p>We will compute <m>271^{321} \pmod{ 481}</m>. Notice that <me>321 = 2^0 +2^6 + 2^8</me>; hence, computing <m>271^{321} \pmod{ 481}</m> is the same as computing <me>271^{2^0 +2^6 + 2^8 } \equiv 271^{2^0} \cdot 271^{2^6} \cdot 271^{2^8} \pmod{481}</me>. So it will suffice to compute <m>271^{2^i} \pmod{481}</m> where <m>i = 0, 6, 8</m>. It is very easy to see that <me>271^{2^1}  = \mbox{73,441} \equiv 329 \pmod{481}</me>. We can square this result to obtain a value for <m>271^{2^2} \pmod{481}</m>:<md>
                <mrow>271^{ 2^2}  &amp; \equiv (271^{ 2^1})^2 \pmod{ 481}</mrow>
                <mrow>&amp; \equiv (329)^2 \pmod{ 481}</mrow>
                <mrow>&amp; \equiv \mbox{108,241} \pmod{ 481}</mrow>
                <mrow>&amp; \equiv 16 \pmod{ 481}</mrow>
            </md>.  We are using the fact that <m>(a^{2^n})^2  \equiv a^{2 \cdot 2^n} \equiv a^{ 2^{n+1} } \pmod{ n}</m>. Continuing, we can calculate <me>271^{ 2^6 } \equiv 419 \pmod{ 481}</me> and <me>271^{ 2^8 }  \equiv 16 \pmod{ 481}</me>. Therefore,<md>
                <mrow>271^{ 321} &amp; \equiv 271^{ 2^0 +2^6 + 2^8 } \pmod{ 481}</mrow>
                <mrow>&amp; \equiv 271^{ 2^0 } \cdot 271^{ 2^6 } \cdot 271^{ 2^8 } \pmod{ 481}</mrow>
                <mrow>&amp; \equiv 271 \cdot 419 \cdot 16 \pmod{ 481}</mrow>
                <mrow>&amp; \equiv \mbox{1,816,784} \pmod{ 481}</mrow>
                <mrow>&amp; \equiv 47 \pmod{ 481}</mrow>
            </md>.</p>
        </example>

<!-- Reformatted example.  TWJ 2/5/2013 -->

        <p> The method of repeated squares will prove to be a very useful tool when we explore  <acro>RSA</acro> cryptography. To encode and decode messages in a reasonable manner under this scheme, it is necessary to be able to quickly compute large powers of integers mod <m>n</m>.</p>

        <xi:include href="./sage/cyclic-info.xml" />
    </section>

    <xi:include href="./exercises/cyclic.xml" />

    <exercises>
        <title>Programming Exercises</title>

        <exercise>
            <statement>
                <p>Write a computer program that will write any decimal number as the sum of distinct powers of 2.  What is the largest integer that yourprogram will handle?</p>
            </statement>
        </exercise>

        <exercise>
            <statement>
                <p>Write a computer program to calculate <m>a^x \pmod{ n}</m> by the method of repeated squares.  What are the largest values of <m>n</m> and <m>x</m> that your program will accept?</p>
            </statement>
        </exercise>

    </exercises>

    <xi:include href="./sage/cyclic-sage-exercises.xml" />

    <references>
        <title>References and Suggested Readings</title>

         <!-- was [1] -->
         <!-- reference updated - TWJ 5/6/2010 -->
        <biblio type="raw">Koblitz, N. <title>A Course in Number Theory and Cryptography</title>. 2nd ed. Springer, New York, 1994.</biblio>

        <!-- was [2] -->
        <biblio type="raw" xml:id="biblio-pomerance-1990">Pomerance, C. <q>Cryptology and Computational Number Theory<mdash />An Introduction,</q> in <title>Cryptology and Computational Number Theory</title>, Pomerance, C., ed. Proceedings of Symposia in Applied Mathematics, vol. 42, American Mathematical Society, Providence, RI, 1990.  Thisbook gives an excellent account of how the method of repeated squares is used in cryptography.</biblio>

    </references>

</chapter>

